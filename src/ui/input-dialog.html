<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Input Value</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            background-color: var(--figma-color-bg);
            color: var(--figma-color-text-secondary);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            padding: 10px;
            box-sizing: border-box;
            font-size: 11px;
        }
        #prompt-title {
            margin-bottom: 15px;
            text-align: center;
            color: var(--figma-color-text-secondary);
            font-size: 11px;
        }
        #value-input {
            width: calc(100% - 20px); /* Full width minus padding */
            padding: 8px;
            border-radius: 4px;
            border: 1px solid var(--figma-color-border);
            background-color: var(--figma-color-bg-secondary);
            color: var(--figma-color-text-secondary);
            font-size: 11px;
            box-sizing: border-box;
        }
        #value-input:focus {
            outline: 2px solid var(--figma-color-bg-brand);
            outline-offset: 0px;
            border-color: var(--figma-color-bg-brand-tertiary);
        }
    </style>
</head>
<body>
    <div id="prompt-title"><span>Set Value</span></div>
    <input type="text" id="value-input">
    <script>
        const inputField = document.getElementById('value-input');
        const promptTitle = document.getElementById('prompt-title');
        let currentPropertyType = '';

        // Focus the input field when the UI is shown
        inputField.focus();

        window.onmessage = (event) => {
            const message = event.data.pluginMessage;
            if (message && message.type === 'init-input-dialog') {
                promptTitle.textContent = message.title || 'Enter Value';
                currentPropertyType = message.propertyType;
                if (message.currentValue !== undefined && message.currentValue !== null) {
                    inputField.value = String(message.currentValue);
                    inputField.select(); // Select the current value for easy replacement
                } else {
                    inputField.value = ''; // Clear if no current value
                }
                inputField.focus(); // Re-focus just in case
            }
        };

        inputField.addEventListener('keydown', (event) => {
            if (event.key === 'Enter') {
                event.preventDefault();
                parent.postMessage({
                    pluginMessage: {
                        type: 'submit-value',
                        propertyType: currentPropertyType,
                        value: inputField.value
                    }
                }, '*');
            } else if (event.key === 'Escape') {
                event.preventDefault();
                parent.postMessage({ pluginMessage: { type: 'close-plugin' } }, '*');
            }
        });

        // Optional: Close if user clicks outside the input/dialog area (might be tricky to implement robustly without more structure)
        // For now, Escape is the primary way to close without submitting.
    </script>
</body>
</html>
